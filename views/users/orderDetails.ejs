<%- include('userSubHeader') %>
<div class="container pt-4">
 <section class="content-main">
    <div class="content-header">
        <div>
            <h2 class="content-title card-title gruppo-regular" style="font-size: 28px; font-weight: bold;">ORDER DETAILS</h2>
            <p>ODR<%= order._id.toString().replace(/\D/g, '').slice(-6) %></p>
        </div>
    </div>
    <div class="card">
        <header class="card-header">
            <div class="row align-items-center"> 
            </div>
        </header> <!-- card-header end// -->
        <div class="card-body">
            <div class="row mb-50 mt-20 order-info-wrap">
                <div class="col-md-4">
                    <article class="icontext align-items-start">
                        <span class="icon icon-sm rounded-circle bg-primary-light">
                            <i class="text-primary material-icons md-person"></i>
                        </span>
                        <div class="text">
                            <h6 class="mb-1 text-danger gruppo-regular" style="font-size: 17px; font-weight: bold;">Your Info</h6>
                            <p class="mb-1 gruppo-regular" style="font-size: 17px;">
                                <%= order.user.name%> <br>  <%= order.user.email%>  <br>   <%= order.user.mobile%> 
                            </p>
                            
                        </div>
                    </article>
                </div> <!-- col// --> 
                <div class="col-md-4">
                    <article class="icontext align-items-start">
                        <span class="icon icon-sm rounded-circle bg-primary-light">
                            <i class="text-primary material-icons md-local_shipping"></i>
                        </span>
                        <div class="text">
                            <h6 class="mb-1 text-danger gruppo-regular" style="font-size: 17px; font-weight: bold;" >Order Info</h6>
                            <p class="mb-1 gruppo-regular" style="font-size: 17px;">
                                Pay method: <%= order.paymentMethod %><br>
                                Status: 
                                <span class="status-box <%= order.status === 'Cancelled' ? 'cancelled' : 'completed' %>">
                                  <%= order.status %>
                                </span>
                              </p>
                              
                              <style>
                                /* Common styles for the status box */
                                .status-box {
                                  display: inline-block;
                                  padding: 5px 10px;
                                  border-radius: 12px;
                                  font-size: 12px;
                                  font-weight: bold;
                                  color: #fff;
                                }
                              
                                /* Specific styles for Cancelled status */
                                .status-box.cancelled {
                                  background-color: #f8d7da; /* Soft red background */
                                  color: #721c24; /* Dark red text */
                                  border: 1px solid #f5c6cb;
                                }
                              
                                /* Specific styles for Completed/Other statuses */
                                .status-box.completed {
                                  background-color: #d4edda; /* Soft green background */
                                  color: #155724; /* Dark green text */
                                  border: 1px solid #c3e6cb;
                                }
                              </style>
                            <p style="font-size: 13px; padding-bottom: 15px; color: rgb(0, 183, 18);" class="mt-2">Delivered within 4 business days</p>

                        </div>
                    </article>
                </div> <!-- col// -->
                <div class="col-md-4">
                    <article class="icontext align-items-start">
                        <span class="icon icon-sm rounded-circle bg-primary-light">
                            <i class="text-primary material-icons md-place"></i>
                        </span>
                        <div class="text">
                            <h6 class="mb-1 text-danger gruppo-regular" style="font-size: 17px; font-weight: bold;">Deliver to</h6>
                            <p class="mb-1 gruppo-regular" style="font-size: 17px;">
                                <%= order.address[0].houseNo %> <%= order.address[0].street %><br>
                                <%= order.address[0].landmark ? `${order.address[0].landmark},` : '' %>
                                <%= order.address[0].city %>, <%= order.address[0].district %>, <%= order.address[0].state %>, <%= order.address[0].country %><br>
                                Pincode: <%= order.address[0].pincode %>
                                <br>
                                Phone: <%= order.address[0].phoneNumber %>
                            </p>
                        </div>
                    </article>
                </div> <!-- col// -->
            </div> <!-- row // -->
            <div class="row">
                <div class="col-lg-7 ">
                    <div class="table-responsive ">
                        <table class="table ">
                            <thead >
                                <tr >
                                    <th width="30%">Product</th>
                                    <th width="20%">Price</th>
                                    <th width="10%">Quantity</th>
                                    <% if (order.products.length !== 1) { %>
                                        <th>Status</th>
                                        <th>Refund Amount</th>
                                    <% } %>
                                </tr>
                            </thead>
                            <tbody >
                                <% order.products.forEach(orderItem => { %>
                                <tr >
                                    <td style="margin-top: 20px;">
                                        <a class="itemside" href="#">
                                            <div class="left">
                                                <img src="<%= orderItem.product.coverimage %>" width="40" height="40" class="img-xs" alt="Item">
                                            </div>
                                            <div class="info"><%= orderItem.product.name %></div>
                                        </a>
                                    </td>
                                    <td><%= orderItem.product.price %></td>
                                    <td><%= orderItem.quantity %></td>
                                    <% if (order.products.length !== 1) { %>
                                        <td>
                                            <% if (orderItem.status) { %>
                                                <span class="<%= orderItem.status === 'Cancelled' ? 'text-danger' : 'text-success' %>">
                                                    <%= orderItem.status %>
                                                </span>
                                            <% } else { %>
                                                <span class="text-warning">Pending</span>
                                            <% } %>
                                        </td>
                                        <td class="bg-light">
                                            <% if (orderItem.status === 'Cancelled') { %>
                                                ₹<%= orderItem.refundAmount || 0 %>  - <%= orderItem.refundStatus %>
                                            <% } else { %>
                                                N/A
                                            <% } %>
                                        </td>
                                    <% } %>
                                </tr>
                                <% }) %>
                                <tr>
                                    <td colspan="5">
                                        <article class="float-end">
                                            <br>
                                            <dl class="dlist">
                                                <dt>Gross :</dt>
                                                <dd> 
                                                    <b class="h5 bg-light">₹<%= order.grandTotal %></b>.00 
                                                </dd>
                                                <% if (order.grandTotal === 0) { %>
                                                    <div class="alert alert-warning mt-4">
                                                        All Items have been canceled.
                                                    </div>
                                                <% } %>
                                            </dl>
                                        </article>
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                        
                    </div> <!-- table-responsive// -->
                    <!-- <a class="btn btn-primary bg-dark" href="page-orders-tracking.html">View Order Tracking</a> -->
                </div> <!-- col// -->
            </div>
        </div> <!-- card-body end// -->
    </div> <!-- card end// -->
</section> <!-- content-main end// -->

</div>

<footer class="main" style="background-color: #9e9e9e; height: 30px;">
   
</footer>
  <!-- Preloader Start -->

  <!-- Vendor JS-->
  <script src="/user/assets/js/vendor/modernizr-3.6.0.min.js"></script>
  <script src="/user/assets/js/vendor/jquery-3.6.0.min.js"></script>
  <script src="/user/assets/js/vendor/jquery-migrate-3.3.0.min.js"></script>
  <script src="/user/assets/js/vendor/bootstrap.bundle.min.js"></script>
  <script src="/user/assets/js/plugins/slick.js"></script>
  <script src="/user/assets/js/plugins/jquery.syotimer.min.js"></script>
  <script src="/user/assets/js/plugins/wow.js"></script>
  <script src="/user/assets/js/plugins/jquery-ui.js"></script>
  <script src="/user/assets/js/plugins/perfect-scrollbar.js"></script>
  <script src="/user/assets/js/plugins/magnific-popup.js"></script>
  <script src="/user/assets/js/plugins/select2.min.js"></script>
  <script src="/user/assets/js/plugins/waypoints.js"></script>
  <script src="/user/assets/js/plugins/counterup.js"></script>
  <script src="/user/assets/js/plugins/jquery.countdown.min.js"></script>
  <script src="/user/assets/js/plugins/images-loaded.js"></script>
  <script src="/user/assets/js/plugins/isotope.js"></script>
  <script src="/user/assets/js/plugins/scrollup.js"></script>
  <script src="/user/assets/js/plugins/jquery.vticker-min.js"></script>
  <script src="/user/assets/js/plugins/jquery.theia.sticky.js"></script>
  <!-- Template  JS -->
  <script src="./user/assets/js/main.js?v=3.4"></script>
 
<!-- Add SweetAlert library -->
<script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>


</body>
</html>
